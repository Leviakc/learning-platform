---
import { Icon } from "astro-icon/components";

export interface Props {
  title?: string;
  description: string;
}

const { title, description } = Astro.props;
---

<div class="p-6">
  <!-- Header section - Responsive layout -->
  <div
    class="mb-4 flex flex-col gap-4 lg:flex-row lg:items-start lg:justify-between lg:gap-0"
  >
    <!-- Title and description - Full width on mobile -->
    <div class="flex-grow">
      <h3 class="text-lg font-semibold">{title}</h3>
      <p class="text-muted-foreground text-sm">{description}</p>
    </div>

    <!-- Buttons - Stack below on mobile, inline on desktop -->
    <div class="flex shrink-0 gap-2 lg:ml-4">
      <!-- Reset Button Slot -->
      <slot name="reset-button">
        <button
          class="border-input bg-background hover:bg-accent hover:text-accent-foreground inline-flex h-9 items-center justify-center gap-2 rounded-md border px-3 text-sm font-medium whitespace-nowrap"
        >
          <Icon name="refresh-ccw" />
          Reset
        </button>
      </slot>

      <!-- Run Tests Button Slot -->
      <slot name="run-button">
        <button
          class="bg-primary text-primary-foreground hover:bg-primary/90 inline-flex h-9 items-center justify-center gap-2 rounded-md px-3 text-sm font-medium whitespace-nowrap"
        >
          <Icon name="play" />
          Run Tests
        </button>
      </slot>
    </div>
  </div>

  <div class="exercise-grid">
    <!-- Code Editor Panel - Takes more space -->
    <div class="code-panel flex flex-col overflow-hidden rounded-lg border">
      <div
        class="bg-muted/50 flex items-center gap-3 border-b p-2 text-sm font-medium"
      >
        <Icon name="terminal" />
        Code Editor
      </div>

      <!-- Monaco Editor Container -->
      <div class="bg-background min-h-0 flex-1">
        <slot name="code-editor">
          <!-- Fallback placeholder -->
          <div
            class="text-muted-foreground bg-muted/10 flex h-full w-full items-center justify-center"
            id="editor-placeholder"
          >
            <div class="text-center">
              <Icon name="code" class="mx-auto mb-4 h-12 w-12" />
              <p>Monaco Editor will load here</p>
            </div>
          </div>
        </slot>
      </div>
    </div>

    <!-- Test Results Panel - Takes less space -->
    <div class="test-panel flex flex-col overflow-hidden rounded-lg border">
      <div
        class="bg-muted/50 flex items-center gap-3 border-b p-2 text-sm font-medium"
      >
        <Icon name="circle-check" />
        Test Results
      </div>

      <!-- Test Results Container -->
      <div class="m-4 min-h-0 flex-1 overflow-y-auto">
        <slot name="test-results">
          <!-- Fallback placeholder -->
          <div class="space-y-2 p-4 text-sm">
            <p class="text-muted-foreground">
              Click 'Run Tests' to see results.
            </p>
          </div>
        </slot>
      </div>
    </div>
  </div>

  <!-- Status/Progress section -->
  <div class="mt-4">
    <slot name="status">
      <!-- Fallback status -->
      <div class="text-center">
        <p class="text-muted-foreground text-sm">
          Complete all tests to continue.
        </p>
      </div>
    </slot>
  </div>
</div>

<style>
  .exercise-grid {
    display: grid;
    gap: 1rem;
    height: 700px;

    /* Mobile: Single column, code editor takes more vertical space */
    grid-template-columns: 1fr;
    grid-template-rows: 3fr 2fr;
  }

  .code-panel {
    grid-row: 1;
  }

  .test-panel {
    grid-row: 2;
  }

  /* Large screens: Two columns, code editor takes 65% width */
  @media (min-width: 1024px) {
    .exercise-grid {
      grid-template-columns: 65fr 35fr;
      grid-template-rows: 1fr;
      height: 500px;
    }

    .code-panel {
      grid-column: 1;
      grid-row: 1;
    }

    .test-panel {
      grid-column: 2;
      grid-row: 1;
    }
  }

  /* Extra large screens: Give even more space to code editor */
  @media (min-width: 1280px) {
    .exercise-grid {
      grid-template-columns: 70fr 30fr;
    }
  }
</style>
